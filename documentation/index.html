<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Documentation | NetOffice Framework</title>
  <meta name="viewport" content="width=device-width">
  
  
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/styles/vendor.min.css">
  <link rel="stylesheet" href="/styles/main.min.css">
  <script async defer="defer" src="https://buttons.github.io/buttons.js"></script>

  <script>!function(t,e,n,c,a,i,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(i=e.createElement(c)).async=1,i.src="https://www.clarity.ms/tag/5i6qncq878",(r=e.getElementsByTagName(c)[0]).parentNode.insertBefore(i,r)}(window,document,"clarity","script")</script>
</head>
<body data-spy="scroll" data-target="#affix" class="">
    <header class="usa-header usa-header-basic" role="banner">
      <div class="usa-nav-container">
        <div class="usa-navbar">
          <div class="usa-logo" id="basic-logo">
            <span class="usa-logo-text">
              <a href="/" title="NetOffice Framework">
                <img id="logo" class="logo" src="/images/NetOfficeOriginalLogo_96x96.png" alt="NetOffice logo" width="32" height="32">
                NetOffice
              </a>
            </span>
          </div>
          <button class="usa-menu-btn">Menu</button>
        </div>
      
        <nav role="navigation" class="usa-nav">
          <button class="usa-nav-close">
            <img src="/images/close.svg" alt="close">
          </button>
      
          <ul class="site-nav-primary usa-nav-primary usa-accordion nav-level0">
            <li>
              <a href="/addins/" title="Office Add-ins" class="usa-nav-link">Office Add-ins</a>
            </li>
            <li>
              <a href="/tutorials/" title="Tutorials" class="usa-nav-link">Tutorials</a>
            </li>
            <li>
              <a href="/toolbox/" title="Toolbox" class="usa-nav-link">Toolbox</a>
            </li>
            <li>
              <a href="/documentation/" title="Documentation" class="usa-nav-link usa-current">Documentation</a>
            </li>
            <li class="nav-link-github-star-button">
              <div class="widget">
                <a class="btn" href="https://github.com/NetOfficeFw/NetOffice" rel="noopener" target="_blank" title="Star NetOfficeFw on GitHub" aria-label="Star NetOfficeFw/NetOffice on GitHub">
                  <svg viewBox="0 0 16 16" width="14" height="14" class="octicon octicon-star" aria-hidden="true">
                    <path fill-rule="evenodd" d="M8 .25a.75.75 0 01.673.418l1.882 3.815 4.21.612a.75.75 0 01.416 1.279l-3.046 2.97.719 4.192a.75.75 0 01-1.088.791L8 12.347l-3.766 1.98a.75.75 0 01-1.088-.79l.72-4.194L.818 6.374a.75.75 0 01.416-1.28l4.21-.611L7.327.668A.75.75 0 018 .25zm0 2.445L6.615 5.5a.75.75 0 01-.564.41l-3.097.45 2.24 2.184a.75.75 0 01.216.664l-.528 3.084 2.769-1.456a.75.75 0 01.698 0l2.77 1.456-.53-3.084a.75.75 0 01.216-.664l2.24-2.183-3.096-.45a.75.75 0 01-.564-.41L8 2.694v.001z">
                    </path>
                  </svg>
                  <span>Star</span>
                </a><a class="social-count" href="https://github.com/NetOfficeFw/NetOffice/stargazers" rel="noopener" target="_blank" aria-label="396 stargazers on GitHub">396</a>
              </div>
            </li>
          </ul>
      
          
      
      
        </nav>
      </div>
    </header>

    <main id="main-content">

      <div class="usa-grid grid-right">
        <div class="col-md-10">
          <article class="content wrap" id="_content" data-uid="">
              <h1 id="documentation">Documentation</h1>
<p><a href="technical/">Technical documentation</a> describes inner working of NetOffice library
in more details.</p>
<h3 id="why-netoffice-">Why NetOffice?</h3>
<p>Usual methods for accessing Microsoft Office using .NET are the Primary Interop Assemblies and VSTO. Both access methods involve various disadvantages:</p>
<ul>
<li>They only work with one or a certain versions of Microsoft Office</li>
<li>They cause problems when transferring or installing on other systems</li>
<li>They offer no protection mechanism for management of COM proxies</li>
</ul>
<p>NetOffice eliminates these disadvantages and remains a 1:1 wrapper that is syntactically and semantically identical to the interop assemblies.</p>
<h3 id="how-does-netoffice-work-">How does NetOffice work?</h3>
<p>NetOffice used to access only LateBinding Calls via COM Interop, but without sacrificing the convenience and simplicity of EarlyBind calls. The slim architecture and efficient design makes this only slightly slower than so-called EarlyBind calls in .NET (max. 10%). Events in NetOffice are implemented with a technique the author calls Dynamic EarlyBinding. Learn more about this in the technical documentation <a href="technical/events.html">Events in NetOffice</a>.</p>
<h3 id="netoffice-contains-a-number-of-assemblies-why-and-which-assemblies-do-i-need-for-my-desired-office-application-">NetOffice contains a number of assemblies. Why and which assemblies do I need for my desired Office application?</h3>
<p>All Office applications use types which are defined in other components/type libraries. These dependent type libraries are therefore given as an independent assembly. Each assembly also requires the NetOffice.dll assembly.  An overview which Office application integrates which additional assemblies can be found here.</p>
<h4 id="deployment-table-">Deployment Table:</h4>
<table>
<thead>
<tr>
<th>Excel</th>
<th>Dependencies</th>
</tr>
</thead>
<tbody>
<tr>
<td>ExcelApi.dll</td>
<td></td>
</tr>
<tr>
<td></td>
<td>OfficeApi.dll</td>
</tr>
<tr>
<td></td>
<td>VBIDEApi.dll</td>
</tr>
<tr>
<td></td>
<td>NetOffice.dll</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Word</th>
<th>Dependencies</th>
</tr>
</thead>
<tbody>
<tr>
<td>WordApi.dll</td>
<td></td>
</tr>
<tr>
<td></td>
<td>OfficeApi.dll</td>
</tr>
<tr>
<td></td>
<td>VBIDEApi.dll</td>
</tr>
<tr>
<td></td>
<td>NetOffice.dll</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Outlook</th>
<th>Dependencies</th>
</tr>
</thead>
<tbody>
<tr>
<td>OutlookApi.dll</td>
<td></td>
</tr>
<tr>
<td></td>
<td>OfficeApi.dll</td>
</tr>
<tr>
<td></td>
<td>VBIDEApi.dll</td>
</tr>
<tr>
<td></td>
<td>NetOffice.dll</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>PowerPoint</th>
<th>Dependencies</th>
</tr>
</thead>
<tbody>
<tr>
<td>PowerPointApi.dll</td>
<td></td>
</tr>
<tr>
<td></td>
<td>OfficeApi.dll</td>
</tr>
<tr>
<td></td>
<td>VBIDEApi.dll</td>
</tr>
<tr>
<td></td>
<td>NetOffice.dll</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Access</th>
<th>Dependencies</th>
</tr>
</thead>
<tbody>
<tr>
<td>AccessApi.dll</td>
<td></td>
</tr>
<tr>
<td></td>
<td>OfficeApi.dll</td>
</tr>
<tr>
<td></td>
<td>DAOApi.dll</td>
</tr>
<tr>
<td></td>
<td>VBIDEApi.dll</td>
</tr>
<tr>
<td></td>
<td>ADODBApi.dll</td>
</tr>
<tr>
<td></td>
<td>OWC10Api.dll</td>
</tr>
<tr>
<td></td>
<td>MSDATASRCApi.dll</td>
</tr>
<tr>
<td></td>
<td>MSComctlLibApi.dll</td>
</tr>
<tr>
<td></td>
<td>NetOffice.dll</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Project</th>
<th>Dependencies</th>
</tr>
</thead>
<tbody>
<tr>
<td>MSProjectApi.dll</td>
<td></td>
</tr>
<tr>
<td></td>
<td>OfficeApi.dll</td>
</tr>
<tr>
<td></td>
<td>VBIDEApi.dll</td>
</tr>
<tr>
<td></td>
<td>MSHTMLApi.dll</td>
</tr>
<tr>
<td></td>
<td>NetOffice.dll</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Visio</th>
<th>Dependencies</th>
</tr>
</thead>
<tbody>
<tr>
<td>VisioApi.dll</td>
<td></td>
</tr>
<tr>
<td></td>
<td>OfficeApi.dll</td>
</tr>
<tr>
<td></td>
<td>VBIDEApi.dll</td>
</tr>
<tr>
<td></td>
<td>NetOffice.dll</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Forms</th>
<th>Dependencies</th>
</tr>
</thead>
<tbody>
<tr>
<td>MSFormsApi.dll</td>
<td></td>
</tr>
<tr>
<td></td>
<td>VisioApi.dll</td>
</tr>
<tr>
<td></td>
<td>OfficeApi.dll</td>
</tr>
<tr>
<td></td>
<td>VBIDEApi.dll</td>
</tr>
<tr>
<td></td>
<td>NetOffice.dll</td>
</tr>
</tbody>
</table>
<h3 id="what-do-i-have-to-do-to-deliver-my-application-with-netoffice-">What do I have to do to deliver my application with NetOffice?</h3>
<p>Nothing except copying the needed assemblies to the target system. You don&#39;t need a registration or something like that with the exception of COMAddIns. Managed COMAddins generally have to be registered via the .NET utility <strong>RegAsm.exe</strong> or the Windows Installer will do that for you.</p>
<h3 id="do-comaddins-also-work-version-independent-">Do COMAddins also work version independent?</h3>
<p>Yes, of course. This is a particular strength of NetOffice. See the code examples for example project for all Office applications but you have to create 2 Addins for 32/64-bit support.</p>
<h3 id="is-netoffice-ready-for-multiple-platforms-32-64-bit-">Is NetOffice ready for multiple platforms (32/64-bit)?</h3>
<p>You can use the NetOffice AnyCPU assemblies in all scenarios. This is true regardless you develop for a 32-bit or 64-bit Microsoft Office application, even independent on which platform these are installed. If your assembly is a standalone application (.exe) or is being loaded by one, you can compile your assembly as AnyCPU without worries.</p>
<p>If your assembly is a COMAddin that is being loaded by a 32-bit Office application, you can still compile it as AnyCPU. If you develop a COMAddin that is being used by a 64-bit Office application, you have to compile your assembly as x64. If you wart to support 32-bit and 64-bit Office applications, you may need to provide a second x64-compiled COMAddin. This behaviour is the same in all scenarios (interop assiemblies, VSTO or NetOffice). A 64-bit application can only load 64-bit dll files.</p>
<p>If you use a 64-bit Office for testing on your development system and you want to register your COMAddin while compiling (<strong>Register for COM interop</strong>), you need to keep in mind that some older versions of Visual Studio call the 32-bit registration in that case. In this case, you get the following error:</p>
<pre><code>&quot;File &lt;path to assembly&gt; is not a valid assembly&quot;
</code></pre><p>You can read a workaround by Microsoft here: <a href="https://support.microsoft.com/en-us/kb/956933">Issues with building a project with &quot;Register for COM interop&quot; for a 64-bit assembly
</a></p>
<h3 id="how-do-i-migrate-my-solution-to-netoffice-">How do I migrate my solution to NetOffice?</h3>
<h4 id="interop-solutions">Interop Solutions</h4>
<p>Change the references and the using(imports in vb) statements. Occasionally, you need to make some adjustments to event triggers. You have to replace all Marshall.ReleaseComObject calls with Dispose. you can also delete the most ReleaseComObject calls because NetOffice manages COM proxies for you. Read more about in the technical documentation <a href="technical/com.html">Understanding COM Proxy Management</a>.</p>
<h4 id="vba-solutions">VBA Solutions</h4>
<p>Developers there want changing a VBA solution to VB.NET and NetOffice has to know that VB.NET is syntactical similar to VBA but has also some different concepts. If you have good VB.NET skills then you have no problems to migrate your solution to NetOffice.</p>
<h3 id="com-proxy-management">COM proxy management</h3>
<p>If you call Office applications (COM servers) .NET returns instead of real objects so-called COM proxies. In order to signal the COM server that you no longer need this, you have to free it with a special method. This applies to VSTO as well as to interop assemblies.</p>
<p>Due to this fact, you must not use no objects implicitly or use Enumerator directly because it then can no longer be released. In NetOffice each object provides the <code>Dispose()</code> method for when you do not need the object anymore. All classes in NetOffice implement the <code>IDisposable</code> interface and also provide the <code>Dispose()</code> method. However, you do not have to call <code>Dispose()</code> for every used object and you may also use objects implicitly and Enumerator directly without having to worry about releasing them afterwards. NetOffice generated proxies are stored in a separate table and are freed when you request it or a parent object is being released. More on that in the <a href="technical/">technical documentation</a> and <a href="../tutorials/tutorial01_en_cs.html">Tutorial01</a>.</p>
<h3 id="unknown-and-variant-types">Unknown and Variant Types</h3>
<p>Many office applications include Properties, return values ​​or parameter whose type is not known at design time and which can change at run time, depending on context. There is a difference between unknown COM proxies and the variant data type which has its roots in the Visual Basic for Applications (VBA).</p>
<p>Unknown COM proxies in NetOffice have the type COMObject. Each class in NetOffice also inherits from this type. The declaration of unkown proxies is Object since NetOffice 1.5.1 as special service for VB developers to use the integrated late binding feature. You can also convert an anonymous COM proxy at run-time into the actual type without problems.</p>
<p>The variant data type is used in VBA for any type to accept both a COM proxy and a scalar data type such as bool or int. In NetOffice that type is replaced by the type object. If a Variant Property is a COM proxy at run time you get an object of the corresponding NetOffice wrapper class, otherwise the the corresponding scalar data type. More on that in the <a href="technical/">technical documentation</a> and <a href="../tutorials/tutorial06_en_cs.html">Tutorial06</a>.</p>
<h3 id="if-netoffice-supports-all-versions-of-office-how-do-i-know-which-office-version-offers-which-functionality-">If NetOffice supports all versions of Office, how do I know which Office version offers which functionality?</h3>
<p>All classes, properties, methods, enums, etc. come with XML documentation and have a special attribute that identifies which Microsoft Office version(s) this entity supports. This information is displayed during development in IntelliSense.</p>
<p>Use the <strong>NetOffice Developer Toolbox</strong> to examine an assembly (created with NetOffice) and see which Microsoft Office versions the assembly supports.
Use this analysis before shipping your assembly to make sure that your program works with the Office versions that you (or your customers) have specified.</p>
<p><img src="assets/NetOffice_IntelliSense.jpg" alt="IntelliSense support in C# for version information of a property."></p>

          </article>
        </div>
      </div>
    </main>
    <footer class="usa-footer usa-footer-medium" role="contentinfo">
      <div class="usa-grid usa-footer-return-to-top">
        <a href="#">Return to top</a>
      </div>
      <div class="usa-footer-secondary_section">
        <div class="usa-grid">
          <div class="usa-width-three-fourths footer-content">
            <h3>Join the community</h3>
            <div class="usa-grid-full footer-contact-links">
    
              <div class="usa-width-one-third">
                <div class="usa-media_block">
                  <img class="usa-media_block-img" src="/images/NetOfficeOriginalLogo_96x96.png" width="40" height="40" alt="">
                  <div class="usa-media_block-body">
                    <h4>NetOffice on GitHub</h4>
                    <a class="xgithub-button" href="https://github.com/NetOfficeFw" aria-label="Follow @NetOfficeFw on GitHub">Follow @NetOfficeFw</a>
                  </div>
                </div>
              </div>
    
              <div class="usa-width-one-third">
                <div class="usa-media_block">
                  <img class="usa-media_block-img" src="/images/icon-question.svg" alt="">
                  <div class="usa-media_block-body">
                    <h4>Running into an issue?</h4>
                    <a class="xgithub-button" href="https://github.com/NetOfficeFw/NetOffice/issues" data-icon="octicon-issue-opened" aria-label="Open issue for NetOffice on GitHub">Ask questions on GitHub</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    
      <div class="footer-section-bottom">
        <div class="usa-grid">
          <p>
            Copyright © 2016-2021 NetOffice Framework. Documentation licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.
            <a class="usa-link-github" href="https://github.com/NetOfficeFw">
              <span>https://github.com/NetOfficeFw</span>
            </a>
          </p>
        </div>
      </div>
    </footer>
</body>
</html>
