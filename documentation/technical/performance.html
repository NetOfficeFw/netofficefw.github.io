<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Technical Documentation | NetOffice Framework</title>
  <meta name="viewport" content="width=device-width">
  
  
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/styles/vendor.min.css">
  <link rel="stylesheet" href="/styles/main.min.css">
  <script async defer="defer" src="https://buttons.github.io/buttons.js"></script>

  <script>!function(t,e,n,c,a,i,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(i=e.createElement(c)).async=1,i.src="https://www.clarity.ms/tag/5i6qncq878",(r=e.getElementsByTagName(c)[0]).parentNode.insertBefore(i,r)}(window,document,"clarity","script")</script>
</head>
<body data-spy="scroll" data-target="#affix" class="">
    <header class="usa-header usa-header-basic" role="banner">
      <div class="usa-nav-container">
        <div class="usa-navbar">
          <div class="usa-logo" id="basic-logo">
            <span class="usa-logo-text">
              <a href="/" title="NetOffice Framework">
                <img id="logo" class="logo" src="/images/NetOfficeOriginalLogo_96x96.png" alt="NetOffice logo" width="32" height="32">
                NetOffice
              </a>
            </span>
          </div>
          <button class="usa-menu-btn">Menu</button>
        </div>
      
        <nav role="navigation" class="usa-nav">
          <button class="usa-nav-close">
            <img src="/images/close.svg" alt="close">
          </button>
      
          <ul class="site-nav-primary usa-nav-primary usa-accordion nav-level0">
            <li>
              <a href="/addins/" title="Office Add-ins" class="usa-nav-link">Office Add-ins</a>
            </li>
            <li>
              <a href="/tutorials/" title="Tutorials" class="usa-nav-link">Tutorials</a>
            </li>
            <li>
              <a href="/toolbox/" title="Toolbox" class="usa-nav-link">Toolbox</a>
            </li>
            <li>
              <a href="/documentation/" title="Documentation" class="usa-nav-link">Documentation</a>
            </li>
            <li class="nav-link-github-star-button">
              <div class="widget">
                <a class="btn" href="https://github.com/NetOfficeFw/NetOffice" rel="noopener" target="_blank" title="Star NetOfficeFw on GitHub" aria-label="Star NetOfficeFw/NetOffice on GitHub">
                  <svg viewBox="0 0 16 16" width="14" height="14" class="octicon octicon-star" aria-hidden="true">
                    <path fill-rule="evenodd" d="M8 .25a.75.75 0 01.673.418l1.882 3.815 4.21.612a.75.75 0 01.416 1.279l-3.046 2.97.719 4.192a.75.75 0 01-1.088.791L8 12.347l-3.766 1.98a.75.75 0 01-1.088-.79l.72-4.194L.818 6.374a.75.75 0 01.416-1.28l4.21-.611L7.327.668A.75.75 0 018 .25zm0 2.445L6.615 5.5a.75.75 0 01-.564.41l-3.097.45 2.24 2.184a.75.75 0 01.216.664l-.528 3.084 2.769-1.456a.75.75 0 01.698 0l2.77 1.456-.53-3.084a.75.75 0 01.216-.664l2.24-2.183-3.096-.45a.75.75 0 01-.564-.41L8 2.694v.001z">
                    </path>
                  </svg>
                  <span>Star</span>
                </a><a class="social-count" href="https://github.com/NetOfficeFw/NetOffice/stargazers" rel="noopener" target="_blank" aria-label="396 stargazers on GitHub">396</a>
              </div>
            </li>
          </ul>
      
          
      
      
        </nav>
      </div>
    </header>

    <main id="main-content">

      <div class="usa-grid grid-right">
        <div class="col-md-10">
          <article class="content wrap" id="_content" data-uid="">
              <h1 id="technical-documentation">Technical Documentation</h1>
<p><a href="../technical/">&lt;&lt; Back</a></p>
<h2 id="performance">Performance</h2>
<p>The following table lists results of three comparative perfomance tests of
different access methods in .NET to Microsoft Office. All tests have been made on a
Windows 7 64-bit workstation (Intel i5-6200U @ 2.30GHz, 16GB RAM) with Microsoft Excel 2013 (32-bit).
You can find the source code to all tests in the <a href="https://github.com/NetOfficeFw/NetOffice/tree/develop/Tests/Performance%20Tests">NetOffice repository</a>.</p>
<p><strong>Test1:</strong> Iterating over 5.000 cells, writing a test value.</p>
<p><strong>Test2:</strong> Iterating over 10.000 cells, writing a test value, changing the
font-face, changing the cell format and call of the <code>BorderArround()</code> method.</p>
<p><strong>Test3:</strong> Iterating over 15.000 cells, writing a test value, changing the
font-face, changing the cell format, changing the <code>WrapText</code> property and adding a
comment.</p>
<p>All tests have been executed 10x and the average value has been noted in this table.</p>
<table>
<thead>
<tr>
<th></th>
<th>Test1</th>
<th>Test2</th>
<th>Test3</th>
</tr>
</thead>
<tbody>
<tr>
<td>MS Interop Assemblies</td>
<td>00:00:05.0154000</td>
<td>00:00:34.1967602</td>
<td>00:01:39.3174006</td>
</tr>
<tr>
<td>VisualBasic LateBinding</td>
<td>00:00:05.7564000</td>
<td>00:00:38.4586802</td>
<td>00:01:45.4887607</td>
</tr>
<tr>
<td>Dynamics in C#</td>
<td>00:00:05.1460800</td>
<td>00:00:51.1430403</td>
<td>00:02:15.1067208</td>
</tr>
<tr>
<td>NetOffice v1.7.3</td>
<td>00:00:05.1667200</td>
<td>00:00:36.7926002</td>
<td>00:01:42.6464406</td>
</tr>
</tbody>
</table>
<h2 id="remarks">Remarks</h2>
<p>All results are very close together when working with small number of calls
to Microsoft Office API.</p>
<p>In managed environment (.NET) the Latebinding access is slower than EarlyBinding,
but this difference is not so significant as in an unmanaged environment.
NetOffice and the Latebinding calling conventions in Visual Basic use caching
mechanisms, so the type information for COM proxy objects do not need to be
requested more than once. This caching mechanism works type-based and ensures
that type-information about a <code>Range</code> object in MS Excel is only request at
first object access. This information can then be reused for all other <code>Range</code>
objects used later on.</p>
<h2 id="dynamics-performance">Dynamics Performance</h2>
<p>Using <em>Dynamics</em> to access Microsoft Office API is very easy. On the other hand,
it provides the least optimal way of calling COM interfaces.</p>
<p>Dynamic objects in C# will retain type information only for the actual
instance of an object, so .NET must fetch type information each time
a new object call COM interface.</p>
<p>When you use a dynamic in a local scope (e.g. a loop) and this scope get destructed
at the end of each single iteration, the dynamic object is discarded together
with its type information. This makes the <strong>Test2</strong> and <strong>Test3</strong> really slow and they
will use much more memory.
In these tests, dynamics use local variables in a <code>foreach</code> loop, which are discarded
after every loop-cycle. This causes significant performance penalty because the
type information has to be refetched in every loop-iteration.</p>
<p><strong>Note:</strong> For types unknown at development time (e.g. <em>Variants</em>),
additional type information has to fetched at runtime.
NetOffice will cache this information to improve the performance slightly.</p>

          </article>
        </div>
      </div>
    </main>
    <footer class="usa-footer usa-footer-medium" role="contentinfo">
      <div class="usa-grid usa-footer-return-to-top">
        <a href="#">Return to top</a>
      </div>
      <div class="usa-footer-secondary_section">
        <div class="usa-grid">
          <div class="usa-width-three-fourths footer-content">
            <h3>Join the community</h3>
            <div class="usa-grid-full footer-contact-links">
    
              <div class="usa-width-one-third">
                <div class="usa-media_block">
                  <img class="usa-media_block-img" src="/images/NetOfficeOriginalLogo_96x96.png" width="40" height="40" alt="">
                  <div class="usa-media_block-body">
                    <h4>NetOffice on GitHub</h4>
                    <a class="xgithub-button" href="https://github.com/NetOfficeFw" aria-label="Follow @NetOfficeFw on GitHub">Follow @NetOfficeFw</a>
                  </div>
                </div>
              </div>
    
              <div class="usa-width-one-third">
                <div class="usa-media_block">
                  <img class="usa-media_block-img" src="/images/icon-question.svg" alt="">
                  <div class="usa-media_block-body">
                    <h4>Running into an issue?</h4>
                    <a class="xgithub-button" href="https://github.com/NetOfficeFw/NetOffice/issues" data-icon="octicon-issue-opened" aria-label="Open issue for NetOffice on GitHub">Ask questions on GitHub</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    
      <div class="footer-section-bottom">
        <div class="usa-grid">
          <p>
            Copyright Â© 2016-2021 NetOffice Framework. Documentation licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.
            <a class="usa-link-github" href="https://github.com/NetOfficeFw">
              <span>https://github.com/NetOfficeFw</span>
            </a>
          </p>
        </div>
      </div>
    </footer>
</body>
</html>
