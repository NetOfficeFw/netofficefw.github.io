<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title> | NetOffice Framework</title>
  <meta name="viewport" content="width=device-width">
  
  
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/styles/vendor.min.css">
  <link rel="stylesheet" href="/styles/main.min.css">
  <script src="/scripts/main.min.js"></script>
  <script async defer="defer" src="https://buttons.github.io/buttons.js"></script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>
</head>
<body data-spy="scroll" data-target="#affix" class="">
    <header class="usa-header usa-header-basic" role="banner">
      <div class="usa-nav-container">
        <div class="usa-navbar">
          <div class="usa-logo" id="basic-logo">
            <span class="usa-logo-text">
              <a href="/" title="NetOffice Framework">
                <img id="logo" class="logo" src="/images/NetOfficeOriginalLogo_96x96.png" alt="NetOffice logo" width="32" height="32">
                NetOffice
              </a>
            </span>
          </div>
          <button class="usa-menu-btn">Menu</button>
        </div>
      
        <nav role="navigation" class="usa-nav">
          <button class="usa-nav-close">
            <img src="/images/close.svg" alt="close">
          </button>
      
          <ul class="site-nav-primary usa-nav-primary usa-accordion nav-level0">
            <li>
              <a href="/addins/" title="Office Add-ins" class="usa-nav-link">Office Add-ins</a>
            </li>
            <li>
              <a href="/tutorials/" title="Tutorials" class="usa-nav-link usa-current">Tutorials</a>
            </li>
            <li>
              <a href="/toolbox/" title="Toolbox" class="usa-nav-link">Toolbox</a>
            </li>
            <li>
              <a href="/documentation/" title="Documentation" class="usa-nav-link">Documentation</a>
            </li>
            <li class="nav-link-github-star-button">
              <div class="widget">
                <a class="btn" href="https://github.com/NetOfficeFw/NetOffice" rel="noopener" target="_blank" title="Star NetOfficeFw on GitHub" aria-label="Star NetOfficeFw/NetOffice on GitHub">
                  <svg viewBox="0 0 16 16" width="14" height="14" class="octicon octicon-star" aria-hidden="true">
                    <path fill-rule="evenodd" d="M8 .25a.75.75 0 01.673.418l1.882 3.815 4.21.612a.75.75 0 01.416 1.279l-3.046 2.97.719 4.192a.75.75 0 01-1.088.791L8 12.347l-3.766 1.98a.75.75 0 01-1.088-.79l.72-4.194L.818 6.374a.75.75 0 01.416-1.28l4.21-.611L7.327.668A.75.75 0 018 .25zm0 2.445L6.615 5.5a.75.75 0 01-.564.41l-3.097.45 2.24 2.184a.75.75 0 01.216.664l-.528 3.084 2.769-1.456a.75.75 0 01.698 0l2.77 1.456-.53-3.084a.75.75 0 01.216-.664l2.24-2.183-3.096-.45a.75.75 0 01-.564-.41L8 2.694v.001z">
                    </path>
                  </svg>
                  <span>Star</span>
                </a><a class="social-count" href="https://github.com/NetOfficeFw/NetOffice/stargazers" rel="noopener" target="_blank" aria-label="396 stargazers on GitHub">396</a>
              </div>
            </li>
          </ul>
      
          
      
      
        </nav>
      </div>
    </header>

    <main id="main-content">

      <div class="usa-grid grid-right">
        <div class="col-md-10">
          <article class="content wrap" id="_content" data-uid="tutorial06_csharp">
              <h1 id="understand-variant-type">Understand Variant Type</h1>
<p>The datatype Variant is not directly supported by .NET CLR, it is common in
unmanaged COM environments though. NetOffice maps the type to object but you never
have to fear you lose the COM Proxy management functions from NetOffice.</p>
<p>See chapter2 in technical documentation for more information.</p>
<pre><code class="hljs lang-csharp"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Tutorial06Main</span>(<span class="hljs-params"></span>)</span>
{
    <span class="hljs-comment">// start application</span>
    Excel.Application application = <span class="hljs-keyword">new</span> Excel.Application();
    application.DisplayAlerts = <span class="hljs-literal">false</span>;

    <span class="hljs-comment">// create new Workbook</span>
    Excel.Workbook book = application.Workbooks.Add();
    Excel.Worksheet sheet = (Excel.Worksheet)book.Worksheets[<span class="hljs-number">1</span>];
    Excel.Range range = sheet.Cells[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>];

    <span class="hljs-comment">// Style is defined as Variant in Excel Type Library and</span>
    <span class="hljs-comment">// it is represented as object type in NetOffice</span>
    Excel.Style style = (Excel.Style)range.Style;

    <span class="hljs-comment">// variant types can be scalar types, another way to us is</span>
    <span class="hljs-keyword">if</span> (range.Style <span class="hljs-keyword">is</span> <span class="hljs-built_in">string</span>)
    {
        <span class="hljs-built_in">string</span> myStyle = range.Style <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>;
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (range.Style <span class="hljs-keyword">is</span> Excel.Style)
    {
        Excel.Style myStyle = (Excel.Style)range.Style;
    }

    <span class="hljs-comment">// Name, Bold, Size are defined as Variant and also</span>
    <span class="hljs-comment">// converted to object</span>
    style.Font.Name = <span class="hljs-string">&quot;Arial&quot;</span>;
    style.Font.Bold = <span class="hljs-literal">true</span>;
    style.Font.Size = <span class="hljs-number">14</span>;

    application.Quit();
    application.Dispose();
}
</code></pre>
<p><a href="tutorial07_en_cs.html">Tutorial 7: Invoker</a></p>

          </article>
        </div>
      </div>
    </main>
    <footer class="usa-footer usa-footer-medium" role="contentinfo">
      <div class="usa-grid usa-footer-return-to-top">
        <a href="#">Return to top</a>
      </div>
      <div class="usa-footer-secondary_section">
        <div class="usa-grid">
          <div class="usa-width-three-fourths footer-content">
            <h3>Join the community</h3>
            <div class="usa-grid-full footer-contact-links">
    
              <div class="usa-width-one-third">
                <div class="usa-media_block">
                  <img class="usa-media_block-img" src="/images/NetOfficeOriginalLogo_96x96.png" width="40" height="40" alt="">
                  <div class="usa-media_block-body">
                    <h4>NetOffice on GitHub</h4>
                    <a class="xgithub-button" href="https://github.com/NetOfficeFw" aria-label="Follow @NetOfficeFw on GitHub">Follow @NetOfficeFw</a>
                  </div>
                </div>
              </div>
    
              <div class="usa-width-one-third">
                <div class="usa-media_block">
                  <img class="usa-media_block-img" src="/images/icon-question.svg" alt="">
                  <div class="usa-media_block-body">
                    <h4>Running into an issue?</h4>
                    <a class="xgithub-button" href="https://github.com/NetOfficeFw/NetOffice/issues" data-icon="octicon-issue-opened" aria-label="Open issue for NetOffice on GitHub">Ask questions on GitHub</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    
      <div class="footer-section-bottom">
        <div class="usa-grid">
          <p>
            Copyright Â© 2016-2021 NetOffice Framework. Documentation licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.
            <a class="usa-link-github" href="https://github.com/NetOfficeFw">
              <span>https://github.com/NetOfficeFw</span>
            </a>
          </p>
        </div>
      </div>
    </footer>
</body>
</html>
